<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="d3.v5.js"></script>
</head>

<body>

</body>

<script>
    d3.json("FakeData.json")
        .then(function (fake_data) {
            console.log(fake_data)

            let sex_data = {
                male: 0,
                female: 0,
                others: 0
            }

            //循环FakeData，判断性别
            let data_length = fake_data.length;
            for (let i = 0; i < data_length; i++) {
                let stu_obj = fake_data[i];

                let stu_sex = stu_obj.性别;

                if (stu_sex === '男') {
                    sex_data.male += 1;
                }
                else if (stu_sex === '女') {
                    sex_data.female += 1;
                }
                else {
                    sex_data.others += 1;
                }
            }

            console.log(sex_data);

            let width = 900,
                height = 500,
                radius = 100;

            let svg = d3.select('body')
                .append('svg')
                .attr('width', width)
                .attr('height', height)
                .style('background-color', '#d9baba');

            //创建一个g元素，来承载可视化图表
            let g = svg.append('g')
                .attr('transform', 'translate(' + width / 2 + ',' + height / 2 + ')');
            //建立
            let pie = d3.pie()
                .value(function (d) { return d.value; })
            let data_ready = pie(d3.entries(sex_data))

            let color = d3.scaleOrdinal()
                .domain(sex_data)
                .range(["#98abc5", "#8a89a6"])

            g.selectAll('whatever')
                .data(data_ready)
                .enter()
                .append('path')
                .attr('d', d3.arc()
                    .innerRadius(50)
                    .outerRadius(radius)
                )
                .attr('fill', function (d) { return (color(d.data.key)) })

                .attr("stroke", "black")//边界
                .style("stroke-width", "2px")

                .style("opacity", 0.7)//透明度

        })
</script>

</html>